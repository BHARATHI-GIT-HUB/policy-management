@model IEnumerable<RepositryAssignement.Models.Plan>
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_CustomeLayout.cshtml";
    var Providers = ViewBag.ProviderMap;

}

<h1 class="my-4">Select Plans</h1>

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">

<style>
    /* Custom font styles */
    body {
        font-family: 'Roboto', sans-serif;
    }

    .card {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: box-shadow 0.3s;
    }

        .card:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

    .card-header {
        background-color: #007bff;
        border-bottom: none;
    }

        .card-header h5 {
            margin-bottom: 0;
        }

    .card-body {
        padding: 1.25rem;
    }

    .card-title {
        font-weight: 500;
        font-size: 1.25rem;
        margin-bottom: 0.75rem;
    }

    .card-subtitle {
        font-weight: 400;
        font-size: 1rem;
        color: #6c757d;
        margin-bottom: 0.5rem;
    }

    .card-text {
        font-size: 0.875rem;
        margin-bottom: 1rem;
    }

    .list-unstyled {
        padding-left: 0;
        margin-bottom: 0;
    }

        .list-unstyled li {
            list-style-type: none;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

    .card-footer {
        border-top: none;
        background-color: transparent;
    }

    .custome-card{
        position:relative;
        width:100px;
        height:50px;
        border:1px solid black;
        left:-100px;
        top:0px;
        z-index:100;
    }

    .accordion-item{

        border:none;
        outline:none;
    }

    .accordion-item, .accordion-button:focus {
        box-shadow:none!important;
        border-color: white!important;
        outline: 0;
        box-shadow: none !important;
        background-color:rgba(232, 232, 232, 0.32) !important;
    }

    .heading{
        color: #253858!important
    }

    .text{
        font-size:15px!important;
        font-weight:400;
        color: #092635 !important
    }
</style>


<form id="cardForm" asp-action="Index" method="post" >
    <input type="hidden" name="selectedCardId" value="" /> <!-- Ensure this input field has a unique name -->

    <div class="accordion" id="">
        @if (Providers != null)
        {
            foreach (var provider in Providers)
            {
                var firstPlan = Model.FirstOrDefault(p => p.ProviderId == provider.Key);
                var otherPlans = Model.Where(p => p.ProviderId == provider.Key).Skip(1);

                <div class="accordion-item mt-5">
                        <button class="accordion-button collapsed inter justify-content-center align-items-center" style="font-weight:500" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-@provider.Key" aria-expanded="false" aria-controls="collapse-@provider.Key">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list-nested" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M4.5 11.5A.5.5 0 0 1 5 11h10a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5m-2-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m-2-4A.5.5 0 0 1 1 3h10a.5.5 0 0 1 0 1H1a.5.5 0 0 1-.5-.5" />
                            </svg>  <span class="mx-2 text-center">@provider.Value Plans</span>
                        </button>
                    
                    @if (firstPlan != null)
                    {
                        <div class="card mb-3" onclick="submitForm(@firstPlan.Id)">
                            <div class="card-body text-center text-sm-start">
                                <div class="d-flex flex-column flex-md-row justify-content-between align-items-center">
                                    <h5 class=" heading">@firstPlan.PlanName</h5>
                                    <h5 class="card-title">@firstPlan.Subtype.Type.Type</h5>
                                </div>
                                <h6 class="card-subtitle mb-1 text-muted">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-heart-fill text-danger mx-2" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314" />
                                    </svg>@firstPlan.Subtype.Subtype
                                </h6>
                                <p class="card-text inter my-2" style="font-size:20px;">@firstPlan.Description</p>
                                <div class="d-flex flex-column flex-md-row justify-content-between align-items-center ">
                                    <ul class="list-unstyled">
                                        <li class="text inter" >
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check-all text-success viewBox="0 0 16 16">
                                                <path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486z" />
                                            </svg>
                                            General Eligibility: @firstPlan.GeneralEliglibity
                                        </li>
                                        <li class="text inter">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check-all text-success viewBox="0 0 16 16">
                                                <path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486z" />
                                            </svg>Minimum Income Eligibility : @firstPlan.MinIncomeEligiblity
                                        </li>
                                        <li class="text inter">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check-all text-success viewBox="0 0 16 16">
                                                <path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486z" />
                                            </svg>Maximum Age Eligibility : @firstPlan.MaxAgeEligiblity
                                        </li>
                                        <li class="text inter">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check-all text-success viewBox="0 0 16 16">
                                                <path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486z" />
                                            </svg>Deductibles : @firstPlan.Deductibles
                                        </li>
                                    </ul>
                               
                                <div class="card-footer d-flex flex-column text inter" style="font-weight:600">
                                        <h6>Max Coverage Amount</h6>
                                        <span class="btn bg-warning btn-sm" style="font-weight:800;color:#F0F0F0  ;letter-spacing: 1px;">@firstPlan.MaxCoverageAmount</span>
                                </div>
                                </div>
                                </div>
                            
                        </div>
                    }

                    <div id="collapse-@provider.Key" class="accordion-collapse collapse" aria-labelledby="heading-@provider.Key" data-bs-parent="#accordionExample">
                        <div class="accordion-body p-0">
                            @foreach (var plan in otherPlans)
                            {
                                <div class="card my-3" onclick="submitForm(@plan.Id)">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <h5 class=" heading">@plan.PlanName</h5>
                                            <h5 class="card-title">@plan.Subtype.Type.Type</h5>
                                        </div>
                                        <h6 class="card-subtitle mb-1 text-muted">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-heart-fill text-danger mx-2" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314" />
                                            </svg>@plan.Subtype.Subtype
                                        </h6>
                                        <p class="card-text inter my-2" style="font-size:20px;">@plan.Description</p>
                                        <div class="d-flex justify-content-between align-items-center ">
                                            <ul class="list-unstyled">
                                                <li class="text inter">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check-all text-success viewBox="0 0 16 16">
                                                        <path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486z" />
                                                    </svg>
                                                    General Eligibility: @plan.GeneralEliglibity
                                                </li>
                                                <li class="text inter">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check-all text-success viewBox="0 0 16 16">
                                                        <path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486z" />
                                                    </svg>Minimum Income Eligibility : @plan.MinIncomeEligiblity
                                                </li>
                                                <li class="text inter">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check-all text-success viewBox="0 0 16 16">
                                                        <path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486z" />
                                                    </svg>Maximum Age Eligibility : @plan.MaxAgeEligiblity
                                                </li>
                                                <li class="text inter">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check-all text-success viewBox="0 0 16 16">
                                                        <path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486z" />
                                                    </svg>Deductibles : @plan.Deductibles
                                                </li>
                                            </ul>

                                            <div class="card-footer d-flex flex-column text inter" style="font-weight:600">
                                                <h6>Max Coverage Amount</h6>
                                                <span class="btn bg-warning btn-sm" style="font-weight:800;color:#F0F0F0  ;letter-spacing: 1px;">@plan.MaxCoverageAmount</span>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            }
                        </div>
                    </div>
                </div>
            }
        }
    </div>

</form>

<script>
    function submitForm(cardId) {
        if (cardId) {
            var hiddenInput = document.querySelector('input[name="selectedCardId"]');
            if (hiddenInput) {
                hiddenInput.value = cardId;
                // Submit the form
                document.getElementById('cardForm').submit();
            } else {
                console.error('Hidden input field not found.');
            }
        } else {
            console.error('Card ID is null.');
        }
    }
</script>
